<VirtualHost *:80>
	ServerName letsXX.smallcubed.com
	DocumentRoot /var/www/lets.smallcubed.com

	RewriteEngine on
    
	# Rewrites for Let's Encrypt
	RewriteCond %{HTTP_HOST} !letsXX\.smallcubed\.com [NC]
	RewriteCond %{REQUEST_URI} ^/\.well-known/(.*)$ [NC]
	RewriteRule ^(.*)$ http://letsXX.smallcubed.com/$1 [L]

	# Special Rewrite for webmin
    RewriteCond %{HTTP_HOST} ^webminXX.smallcubed.com$  [NC]
    RewriteRule ^(.*)$ https://scXX.smallcubed.com:10801 [R=301,L]

	# Rewrite everything else to secure connection
	RewriteCond %{HTTP_HOST} !letsXX\.smallcubed\.com [NC]
    RewriteCond %{HTTPS} off
    RewriteRule (.*) https://%{HTTP_HOST}%{REQUEST_URI} [R=301,L]
    
	ErrorLog ${APACHE_LOG_DIR}/error.log
	CustomLog ${APACHE_LOG_DIR}/access.log combined
</VirtualHost>

